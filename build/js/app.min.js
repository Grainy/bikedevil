var ajaxLoop=function(e){var t=function(){i()},i=function(){var t,i,n,o=3,a=1,s=!1,r=null,l="Latest Posts",c=!0,u=function(r,l){s===!1&&(s=!0,o=1===a?4:3,i=r?"/wp-json/posts?type=post&filter[category_name]="+r+"&filter[posts_per_page]="+o+"&page="+a:"/wp-json/posts?type=post&filter[posts_per_page]="+o+"&page="+a,e.ajax({type:"GET",url:i,dataType:"json",beforeSend:function(){e(".loading").show()},success:function(i,r,u){t=c?u.getResponseHeader("X-WP-Total")/(o-1):u.getResponseHeader("X-WP-Total")/o,e(".loading").hide();for(var d=0;d<i.length;d++){var p=i[d].content.replace(/<\/?[^>]+>/gi,"");p=p.split(" ").slice(0,20).join(" "),n=moment(i[d].date).fromNow();var h,f=i[d].content.match(/<img[^>]+>/);if("http://staging.bikedevil.net/wp/wp-includes/images/media/default.png"!==i[d].thumb_url)h=i[d].thumb_url;else if(null!==f){f[0];h=e(f[0]).attr("src")}else h=i[d].thumb_url;0===d&&c?(e(".l-archive__row").before('<h2 class="col-md-6 l-archive__title"><a href="/news">'+l+"</a></h2>"),e(".l-archive__row").prepend('<div class="col-sm-12 l-archive__post l-archive__post--featured l-archive__post--'+d+'"><a href="'+i[d].link+'" class="l-archive__post--thumb-container" style="background-image: url('+h+')"></a><div class="l-archive__post--container"><h3 class="l-archive__post--title"><a href="'+i[d].link+'">'+i[d].title+'</a></h3><p class="l-archive__post--meta">from '+i[d].author.name+" | "+n+'</p><p class="l-archive__post--excerpt">'+p+'</p><a href="'+i[d].link+'" class="b-button">Read More</a></div></div>')):e(".l-archive__row").append('<div class="col-sm-4 l-archive__post l-archive__post--'+d+' js-match-height"><a href="'+i[d].link+'" class="l-archive__post--thumb-container" style="background-image: url('+h+')"></a><div class="l-archive__post--container"><h3 class="l-archive__post--title"><a href="'+i[d].link+'">'+i[d].title+'</a></h3><p class="l-archive__post--meta">from '+i[d].author.name+'<p class="l-archive__post--date">'+n+'<p class="l-archive__post--excerpt">'+p+"</p></div></div>"),e(".l-archive__post--"+d).fadeIn(500)}e(".js-match-height").matchHeight();var v=e(window).height();v-=100,c=!1,a++,s=!1},error:function(t,i,n){e(".loading").hide()}}))};e(".js-archive-filter").on("change.fs",function(){var t,i,n=this.value,o=e(".trigger").text();console.log(this.value),"all"===n?(t=null,i="Latest News"):(t=n,i=o),e(".l-archive__title").remove(),e(".l-archive__row").empty(),a=1,c=!0,u(t,i)}),is_archive&&is_news===!0&&e(window).scroll(function(){t>=a&&e(window).scrollTop()+e(window).height()==e(document).height()&&null===is_device&&u(r)}),e(".js-load-more").on("click",function(e){e.preventDefault(),t>=a&&u(r)}),u(r,l)};return{init:t}}(jQuery);!function(e){var t="undefined"!=typeof e("<input/>")[0].multiple,i=/msie/i.test(navigator.userAgent);e.fn.customFile=function(){return this.each(function(){var n=e(this).addClass("custom-file-upload-hidden"),o=e('<div class="file-upload-wrapper">'),a=e('<input type="text" class="file-upload-input" />'),s=e('<button type="button" class="file-upload-button">Choose File</button>'),r=e('<label class="file-upload-button" for="'+n[0].id+'">Choose File</label>');n.css({position:"absolute",left:"-9999px"}),o.insertAfter(n).append(n,a,i?r:s),n.attr("tabIndex",-1),s.attr("tabIndex",-1),s.click(function(){n.focus().click()}),n.change(function(){var e,i,o=[];if(t){e=n[0].files;for(var s=0,r=e.length;r>s;s++)o.push(e[s].name);i=o.join(", ")}else i=n.val().split("\\").pop();a.val(i).attr("title",i).focus()}),a.on({blur:function(){n.trigger("blur")},keydown:function(e){if(13===e.which)i||n.trigger("click");else{if(8!==e.which&&46!==e.which)return 9===e.which?void 0:!1;n.replaceWith(n=n.clone(!0)),n.trigger("change"),a.val("")}}})})},t||e(document).on("change","input.customfile",function(){var t=e(this),i="customfile_"+(new Date).getTime(),n=t.parent(),o=n.siblings().find(".file-upload-input").filter(function(){return!this.value}),a=e('<input type="file" id="'+i+'" name="'+t.attr("name")+'"/>');setTimeout(function(){t.val()?o.length||(n.after(a),a.customFile()):(o.parent().remove(),n.appendTo(n.parent()),n.find("input").focus())},1)})}(jQuery),jQuery("input[type=file]").customFile();var gallery=function(e){var t=function(){i()},i=function(){e(".lightbox").magnificPopup({delegate:"a",type:"image",gallery:{enabled:!0}}),e(".popup-modal").magnificPopup({type:"inline",preloader:!1,focus:"#username",modal:!0}),e(document).on("click",".popup-modal-dismiss",function(t){t.preventDefault(),e.magnificPopup.close()})};return{init:t}}(jQuery);gallery.init();var mobileNav=function(e){var t=function(){i()},i=function(){e(".burger-icon").on("click",function(){e(".burger-icon, .js-mobile-nav").toggleClass("menu-active"),e("body").toggleClass("disabled")})};return{init:t}}(jQuery),secondaryNav=function(e){var t=this,i=function(){n(),e("html").hasClass("prel-touch-device")||s(),o()},n=function(){e("html").addClass("no-touch-device"),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(t.preliminaryTouch=!0),t.preliminaryTouch&&e("html").addClass("prel-touch-device"),e(document).on("touchstart",function(){e("html").removeClass("no-touch-device prel-touch-device").addClass("touch-device")})},o=function(){e("#secondary-nav").on("change.fs",a)},a=function(t){e(this).trigger("change.$"),e("#secondary-nav option:selected").each(function(){window.location=e(this).val()})},s=function(){var t,i;e(".b-secondary-nav__nav--link.current-menu-item").length>0?(t=e(".b-secondary-nav__nav .current-menu-item").width(),i=e(".b-secondary-nav__nav .current-menu-item").position().left):(i=0,t=e(".b-secondary-nav__nav li").width());var n;e(".b-secondary-nav__nav--slider").css({left:i,width:t}),e(".b-secondary-nav__nav li").hover(function(){var t=e(this).position().left,i=e(this).width();e(".b-secondary-nav__nav--slider").stop(),e(".b-secondary-nav__nav--slider").animate({width:i,left:t},{duration:500,specialEasing:{width:"linear",height:"easeOutBounce"}},function(){n=e(".b-secondary-nav__nav--slider").css("left")})},function(){e(".b-secondary-nav__nav--slider").css("left",n)}),e(".b-secondary-nav__nav").hover(function(){},function(){e(".b-secondary-nav__nav--slider").stop(),e(".b-secondary-nav__nav--slider").animate({left:i,width:t},{duration:500,specialEasing:{width:"linear",height:"easeOutBounce"}},function(){n=e(".b-secondary-nav__nav--slider").css("left")})}),e("[data-cat]").on("click",function(n){n.preventDefault(),t=e(this).outerWidth(),i=e(this).position().left})};return{init:i}}(jQuery),sharing=function(e){"use strict";function t(){e(".js-fb-share").on("click",function(e){e.preventDefault(),i()})}var i=function(){var e=window.location.href;FB.ui({method:"feed",link:e},function(e){})};return{init:t}}(jQuery);jQuery(document).ready(function(e){sharing.init()});var slider=function(e){var t=function(){i()},i=function(){var t;t=e(".slide-content").length>1,e(".flexslider").flexslider({animation:"slide",touch:t,controlNav:!1,nextText:"",prevText:""})};return{init:t}}(jQuery),stickyWidget=function(e){var t,i=function(){n()},n=function(){var i=e(".b-popular-posts"),n=i.offset().top,o=i.offset().left,a=i.outerWidth();e(window).scroll(function(){var i=e(window).scrollTop(),s=n-i;i+105>n&&0>=s?t||(t=!0,e(".b-popular-posts").addClass("fixed"),e(".b-popular-posts").css({left:o,width:a})):t&&(e(".b-popular-posts").removeClass("fixed"),e(".b-popular-posts").css("left","auto"),t=!1)})};return{init:i}}(jQuery),boilerAPP=function(e){this.resizeCooldown=!0,this.settings={screenWidth:0,screenHeight:0,videoCapabilities:!0,screenSize:"desk",homeExpanded:!1,isAnimating:!1,modalOpen:!1,mousewheelSet:!1,debug:!1,isOpen:!1,isCareersOpen:!1,isSnapped:!1},this.domElements={body:e("body"),blogPost:e(".l-blog-detail"),vidModal:e("#vid-modal"),footer:e(".l-footer")};var t=function(){i(),n(),o(),a(),e(window).resize(function(){o()})},i=function(){e(".js-match-height").matchHeight(),e(".js-back-button").on("click",function(e){return e.preventDefault(),parent.history.back(),!1}),e("select").fancySelect()},n=function(){e("header").headroom({offset:90,tolerance:{up:50,down:0},classes:{initial:"animated",pinned:"slideDown",unpinned:"slideUp"}})},o=function(){e(".b-call-to-action").each(function(t,i){var n=e(".b-call-to-action").eq(t).width();e(".b-call-to-action").eq(t).css("height",n)})},a=function(){e(".l-gallery-strip").slick({slidesToShow:6,slidesToScroll:1,autoplay:!0,autoplaySpeed:2e3,arrows:!0,prevArrow:'<a class="slider-prev"></a>',nextArrow:'<a class="slider-next"></a>',responsive:[{breakpoint:1200,settings:{slidesToShow:6,centerPadding:"0px"}},{breakpoint:960,settings:{slidesToShow:3,arrows:!1,dots:!0,centerPadding:"0px"}},{breakpoint:800,settings:{slidesToShow:2,arrows:!1,dots:!0,centerPadding:"0px"}},{breakpoint:500,settings:{slidesToShow:1,arrows:!1,dots:!0,centerPadding:"0px"}}]}),e(".l-gallery-strip").slickLightbox()};return{init:t}}(jQuery);jQuery(document).ready(function(e){boilerAPP.init(),slider.init(),mobileNav.init(),ajaxLoop.init(),e(".b-secondary-nav__nav").length>0&&secondaryNav.init(),e(".b-popular-posts").length>0&&e(window).width()>=991&&stickyWidget.init()});